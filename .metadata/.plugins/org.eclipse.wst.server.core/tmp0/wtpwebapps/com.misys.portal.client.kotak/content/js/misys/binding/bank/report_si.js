/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.bank.report_si"]){dojo._hasResource["misys.binding.bank.report_si"]=true;dojo.provide("misys.binding.bank.report_si");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.SimpleTextarea");dojo.require("dojo.data.ItemFileReadStore");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.file");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("misys.form.addons");dojo.require("misys.binding.bank.report_si_swift");dojo.require("misys.widget.Amendments");(function(d,dj,m){m._config.siMandatoryFields=[];var _1,_2;var _3="doc-details";var _4="NOT ALLOWED";function _5(){if(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")=="05"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!=="01"){var _6=dj.byId("release_amt");var _7=dj.byId("org_lc_liab_amt");var _8=dj.byId("release_amt")?dj.byId("release_amt").get("value"):"";var _9=dojo.number.parse(_7.get("value"))||0;if(_6&&_7&&(_8<=0||_8>_9)){m.dialog.show("ERROR",m.getLocalization("canNotReleaseTheTransaction"));dj.byId("lc_liab_amt").set("value",_9);return false;}if(!isNaN(_8)){var _a=_9-_8;dj.byId("lc_liab_amt").set("value",_a);return true;}else{dj.byId("lc_liab_amt").set("value",_9);}}return true;};function _b(){var _c=dj.byId("lc_liab_amt");var _d=dj.byId("lc_amt");var _e=dj.byId("claim_amt");if(_d&&_e){if(_e.get("value")<=0||_e.get("value")>_c.get("value")||_e.get("value")>_d.get("value")){var _f=function(){var _10=dijit.byId("claim_amt");_10.focus();_10.set("state","Error");};m.dialog.show("ERROR",m.getLocalization("claimAmtGreaterThanOutstandingAmtError",[_c.get("value").toFixed(2)]),"",function(){setTimeout(_f,500);});return false;}}return true;};function _11(){var _12=dj.byId("current_date");var _13=dj.byId("exp_date");var _14=dj.byId("iss_date");var _15=dj.byId("claim_present_date");if(_15){if(_12&&!m.compareDateFields(_15,_12)){var _16=function(){var _17=dijit.byId("claim_present_date");_17.focus();_17.set("state","Error");};m.dialog.show("ERROR",m.getLocalization("claimDateGreaterThanCurrentDateError",[_15.get("displayedValue"),_12.get("displayedValue")]),"",function(){setTimeout(_16,500);});return false;}else{if(_13&&!m.compareDateFields(_15,_13)){var _18=function(){return true;};m.dialog.show("WARNING",m.getLocalization("claimDateGreaterThanExpiryDateError",[_15.get("displayedValue"),_13.get("displayedValue")]),"",function(){setTimeout(_18,500);});}else{if(_14&&!m.compareDateFields(_14,_15)){var _19=function(){return true;};m.dialog.show("WARNING",m.getLocalization("claimDateLessThanIssueDateError",[_15.get("displayedValue"),_14.get("displayedValue")]),"",function(){setTimeout(_19,500);});}}}}return true;};function _1a(){if(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")==="05"){var _1b=dj.byId("prod_stat_code"),_1c=null,_1d=null;if(dj.byId("lc_liab_amt")){var _1e=dojo.number.parse(dj.byId("lc_liab_amt"));}if(_1b){_1c={"identifier":"id","items":[]};_1d=new dojo.data.ItemFileWriteStore({data:_1c});if(_1e&&_1e>0){_1d.newItem({"id":"76","name":m.getLocalization("Approved")});_1d.newItem({"id":"01","name":m.getLocalization("Not_Processed")});if(_1b.get("value")!=="01"&&_1b.get("value")!=="76"){_1b.set("displayedValue","");_1b.set("value","");}_1b.store=null;_1b.store=_1d;dj.byId("lc_release_flag").set("value","N");}else{_1d.newItem({"id":"76","name":m.getLocalization("Approved")});_1d.newItem({"id":"01","name":m.getLocalization("Not_Processed")});if(_1b.get("value")!=="01"&&_1b.get("value")!=="76"){_1b.set("displayedValue","");_1b.set("value","");}_1b.store=null;_1b.store=_1d;dj.byId("lc_release_flag").set("value","Y");}}}};d.mixin(m._config,{xmlTransform:function(xml){var _1f="<si_tnx_record>";if(xml.indexOf(_1f)!=-1){var _20=m._config.xmlTagName,_21=_20?["<",_20,">"]:[],_22="</si_tnx_record>",_23="",_24=-1;_23=xml.substring(_1f.length,(xml.length-_22.length));var i=0,_25,_1,itr=0;var _26="amd_no";var _27=xml.substring(xml.indexOf("<"+_26+">")+("<"+_26+">").length,xml.indexOf("</"+_26+">"));var _28=xml.substring(xml.indexOf("<tnx_type_code>")+("<tnx_type_code>").length,xml.indexOf("</tnx_type_code>"));var _29=xml.substring(xml.indexOf("<prod_stat_code>")+("<prod_stat_code>").length,xml.indexOf("</prod_stat_code>"));var _2a=["narrative_description_goods","narrative_documents_required","narrative_additional_instructions","narrative_special_beneficiary","narrative_special_recvbank"];if(m._config.swift2018Enabled&&(Number(_27)||_29==="08"||_29==="31")){var _2b;var _2c=[m._config.narrativeDescGoodsDataStore,m._config.narrativeDocsReqDataStore,m._config.narrativeAddInstrDataStore,m._config.narrativeSpBeneDataStore,m._config.narrativeSpRecvbankDataStore];for(itr=0;itr<5;itr++){_2b=itr==0?_23.substring(0,_23.indexOf("<"+_2a[itr]+">")):(_2b.indexOf("<"+_2a[itr]+">")>0?_2b.substring(0,_2b.indexOf("<"+_2a[itr]+">")):_2b);if(_23.indexOf("<"+_2a[itr]+">")<0){continue;}if(_2c[itr]&&_2c[itr].length>0){i=0;_2b=_2b.concat("<"+_2a[itr]+">");_2b=_2b.concat("<![CDATA[");_2b=_2b.concat("<amendments>");_2b=_2b.concat("<amendment>");_2b=_2b.concat("<sequence>");_2b=_2b.concat("");_2b=_2b.concat("</sequence>");_2b=_2b.concat("<data>");d.forEach(_2c[itr],function(){if(_2c[itr][i]&&_2c[itr][i]!=null){_25=_2c[itr][i].verb[0];_1=dojox.html.entities.encode(_2c[itr][i].content[0],dojox.html.entities.html);_2b=_2b.concat("<datum>");_2b=_2b.concat("<id>");_2b=_2b.concat(i);_2b=_2b.concat("</id>");_2b=_2b.concat("<verb>");_2b=_2b.concat(_25);_2b=_2b.concat("</verb>");_2b=_2b.concat("<text>");_2b=_2b.concat(_1);_2b=_2b.concat("</text>");_2b=_2b.concat("</datum>");}i++;});_2b=_2b.concat("</data>");_2b=_2b.concat("</amendment>");_2b=_2b.concat("</amendments>");_2b=_2b.concat("]]>");_2b=_2b.concat(_23.substring(_23.indexOf("</"+_2a[itr]+">"),_23.length));}else{_2b=_2b.concat("<"+_2a[itr]+">");_2b=_2b.concat(_23.substring(_23.indexOf("</"+_2a[itr]+">"),_23.length));}}_21.push(_2b);}else{if(m._config.swift2018Enabled&&_28==="01"){for(itr=0;itr<5;itr++){_2b=itr==0?_23.substring(0,_23.indexOf("<"+_2a[itr]+">")):_2b.substring(0,_2b.indexOf("<"+_2a[itr]+">"));_2b=_2b.concat("<"+_2a[itr]+">");if(dj.byId(_2a[itr])){_2b=_2b.concat("<![CDATA[");_2b=_2b.concat("<issuance>");_2b=_2b.concat("<sequence>");_2b=_2b.concat("0");_2b=_2b.concat("</sequence>");_2b=_2b.concat("<data>");_2b=_2b.concat("<datum>");_2b=_2b.concat("<id>");_2b=_2b.concat("0");_2b=_2b.concat("</id>");_2b=_2b.concat("<verb>");_2b=_2b.concat("ISSUANCE");_2b=_2b.concat("</verb>");_2b=_2b.concat("<text>");_2b=_2b.concat(dojox.html.entities.encode(dj.byId(_2a[itr]).get("value"),dojox.html.entities.html));_2b=_2b.concat("</text>");_2b=_2b.concat("</datum>");_2b=_2b.concat("</data>");_2b=_2b.concat("</issuance>");_2b=_2b.concat("]]>");}_2b=_2b.concat(_23.substring(_23.indexOf("</"+_2a[itr]+">"),_23.length));}_21.push(_2b);}else{_21.push(_23);}}if(dj.byId("gridLicense")&&dj.byId("gridLicense").store&&dj.byId("gridLicense").store!==null&&dj.byId("gridLicense").store._arrayOfAllItems.length>0){_21.push("<linked_licenses>");dj.byId("gridLicense").store.fetch({query:{REFERENCEID:"*"},onComplete:dojo.hitch(dj.byId("gridLicense"),function(_2d,_2e){dojo.forEach(_2d,function(_2f){_21.push("<license>");_21.push("<ls_ref_id>",_2f.REFERENCEID,"</ls_ref_id>");_21.push("<bo_ref_id>",_2f.BO_REF_ID,"</bo_ref_id>");_21.push("<ls_number>",_2f.LS_NUMBER,"</ls_number>");_21.push("<ls_allocated_amt>",_2f.LS_ALLOCATED_AMT,"</ls_allocated_amt>");_21.push("<ls_amt>",_2f.LS_AMT,"</ls_amt>");_21.push("<ls_os_amt>",_2f.LS_OS_AMT,"</ls_os_amt>");_21.push("<converted_os_amt>",_2f.CONVERTED_OS_AMT,"</converted_os_amt>");_21.push("<allow_overdraw>",_2f.ALLOW_OVERDRAW,"</allow_overdraw>");_21.push("</license>");});})});_21.push("</linked_licenses>");}if(_20){_21.push("</",_20,">");}return _21.join("");}else{return xml;}}});d.mixin(m,{bind:function(){m.setValidation("iss_date",m.validateIssueDate);m.setValidation("amd_date",m.validateAmendmentDate);m.setValidation("exp_date",m.validateBankExpiryDate);m.setValidation("pstv_tol_pct",m.validateTolerance);m.setValidation("neg_tol_pct",m.validateTolerance);m.setValidation("max_cr_desc_code",m.validateMaxCreditTerm);m.setValidation("last_ship_date",m.validateLastShipmentDate);m.setValidation("lc_cur_code",m.validateCurrency);m.setValidation("latest_answer_date",m.validateLatestAnswerDate);m.setValidation("renew_for_nb",m.validateRenewFor);m.setValidation("advise_renewal_days_nb",m.validateDaysNotice);m.setValidation("rolling_renewal_nb",m.validateNumberOfRenewals);m.setValidation("rolling_cancellation_days",m.validateCancellationNotice);m.setValidation("rolling_renew_for_nb",m.validateRollingFrequency);m.setValidation("renewal_calendar_date",m.validateRenewalCalendarDate);m.setValidation("renew_on_code",m.validateRenewalCalendarDate);m.setValidation("lc_govern_country",m.validateCountry);m.connect("ntrf_flag","onClick",m.toggleTransferIndicatorFlag);m.setValidation("earliest_ship_date",m.validateEarliestShipmentDate);m.connect("ship_period","onChange",m.validateShipPeriod);m.connect("courier_partner","onChange",m.validatecourierPartnerField);m.connect("last_ship_date","onClick",function(){if(m._config.shipment_period_standard===true){m.toggleDependentFields(this,dj.byId("narrative_shipment_period"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));}});m.connect("last_ship_date","onChange",function(){if(m._config.shipment_period_standard===true){m.toggleDependentFields(this,dj.byId("narrative_shipment_period"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));}});m.setValidation("bo_comment",m.bofunction);m.connect("projected_expiry_date","onChange",function(){var _30=dj.byId("exp_date");var _31=dj.byId("final_expiry_date");var _32=function(){dj.hideTooltip(dj.byId("projected_expiry_date").domNode);};var _33=this.get("displayedValue");if(_30&&!m.compareDateFields(_30,this)){this.set("value",null);dj.showTooltip(m.getLocalization("projectedExpDateLessThanTransactionExpDtError",[_33,_30.get("displayedValue")]),dj.byId("projected_expiry_date").domNode,0);setTimeout(_32,2000);}else{if(_31&&!m.compareDateFields(this,_31)){this.set("value",null);dj.showTooltip(m.getLocalization("projectedExpDateGreaterThanFinalExpDtError",[_33,_31.get("displayedValue")]),dj.byId("projected_expiry_date").domNode,0);setTimeout(_32,2000);}}});m.connect("inco_term_year","onChange",m.getIncoTerm);m.connect("inco_term_year","onChange",function(){m.toggleFields(this.get("value"),null,["inco_term"],false,true);});m.connect("inco_term","onChange",function(){m.toggleFields(this.get("value"),null,["inco_place"],false,false);});m.connect("delivery_to","onChange",m.getDeliveryTo);m.connect("delivery_to","onChange",function(){m.toggleFields((this.get("value")==="02"||this.get("value")==="04"||this.get("value")==="05"),null,["narrative_delivery_to"]);});m.connect("final_expiry_date","onChange",function(){var _34=dj.byId("exp_date");var _35=dj.byId("projected_expiry_date");var _36=function(){dj.hideTooltip(dj.byId("final_expiry_date").domNode);};var _37=this.get("displayedValue");if(_34&&!m.compareDateFields(_34,this)){this.set("value",null);this.set("state","Error");dj.showTooltip(m.getLocalization("finalExpDateLessThanTransactionExpDtError",[_37,_34.get("displayedValue")]),dj.byId("final_expiry_date").domNode,0);setTimeout(_36,2000);}else{if(_35&&!m.compareDateFields(_35,this)){this.set("value",null);dj.showTooltip(m.getLocalization("finalExpDateLessThanProjectedExpDtError",[_37,_35.get("displayedValue")]),dj.byId("final_expiry_date").domNode,0);setTimeout(_36,2000);}}});m.setValidation("claim_cur_code",m.validateCurrency);m.setValidation("claim_reference",m.validateSwiftAddressCharacters);m.connect("claim_amt","onBlur",_b);m.connect("claim_reference","onBlur",m.checkClaimReferenceExists);m.connect("claim_present_date","onBlur",_11);m.connect("prod_stat_code","onChange",function(){if(this.get("value")==="84"){m.animate("fadeIn",d.byId("claimDetails"));m.animate("fadeOut",d.byId(_3));dj.byId("claim_cur_code").set("value",dj.byId("lc_cur_code").get("value"));dj.byId("claim_reference").set("disabled",false);dj.byId("claim_present_date").set("disabled",false);dj.byId("claim_amt").set("disabled",false);dj.byId("claim_cur_code").set("disabled",false);dj.byId("action_req_code").store.root.options.remove(4);m.setCurrency(dj.byId("claim_cur_code"),["claim_amt"]);}else{if(dj.byId("claim_reference")&&dj.byId("claim_present_date")&&dj.byId("claim_amt")&&dj.byId("claim_cur_code")){m.animate("fadeOut",d.byId("claimDetails"));m.animate("fadeIn",d.byId(_3));dj.byId("claim_reference").set("disabled",true);dj.byId("claim_present_date").set("disabled",true);dj.byId("claim_amt").set("disabled",true);dj.byId("claim_cur_code").set("disabled",true);dj.byId("claim_reference").set("value","");dj.byId("claim_present_date").set("value",null);dj.byId("claim_amt").set("value","");dj.byId("claim_cur_code").set("value","");if((!dj.byId("action_req_code").store.root.options[4])||(dj.byId("action_req_code").store.root.options[4]&&dj.byId("action_req_code").store.root.options[4].value!==_2)){dj.byId("action_req_code").store.root.options.add(new Option(_1,_2,false,false));}}}});m.connect("prod_stat_code","onChange",m.validateOutstandingAmount);m.connect(dj.byId("prod_stat_code"),"onChange",function(){this.validate();if(m._config.swift2018Enabled){m.refreshUIforAmendment();}var _38=dj.byId("prod_stat_code");var _39=dj.byId("imp_bill_ref_id");if(_38&&_38.get("value")&&_39){var _3a=dj.byId("prod_stat_code").get("value");if(_3a==="04"||_3a==="07"||_3a==="12"||_3a==="13"||_3a==="05"||_3a==="14"||_3a==="15"){dj.byId("imp_bill_ref_id").set("disabled",false);}else{dj.byId("imp_bill_ref_id").set("disabled",true);dj.byId("imp_bill_ref_id").set("value","");}}});m.connect("irv_flag","onClick",m.checkIrrevocableFlag);m.connect("ntrf_flag","onClick",m.toggleTransferIndicatorFlag);m.connect("ntrf_flag","onClick",m.checkNonTransferableFlag);m.connect("stnd_by_lc_flag","onClick",m.checkStandByFlag);if(m._config.swift2018Enabled){m._bindSwift2018();}else{m.connect("cfm_inst_code_1","onClick",m.resetConfirmationCharges);m.connect("cfm_inst_code_2","onClick",m.resetConfirmationCharges);m.connect("cfm_inst_code_3","onClick",m.resetConfirmationCharges);}m.connect("cfm_chrg_brn_by_code_1","onClick",m.checkConfirmationCharges);m.connect("cfm_chrg_brn_by_code_2","onClick",m.checkConfirmationCharges);m.connect("cr_avl_by_code_1","onClick",m.togglePaymentDraftAt);m.connect("cr_avl_by_code_1","onClick",m.setDraftTerm);m.connect("cr_avl_by_code_2","onClick",m.togglePaymentDraftAt);m.connect("cr_avl_by_code_3","onClick",m.togglePaymentDraftAt);m.connect("cr_avl_by_code_4","onClick",m.togglePaymentDraftAt);m.connect("cr_avl_by_code_5","onClick",m.togglePaymentDraftAt);m.connect("cr_avl_by_code_6","onClick",m.togglePaymentDraftAt);m.connect("cr_avl_by_code_5","onChange",function(){dj.byId("draft_term").set("value","");});m.connect("tenor_type_1","onClick",m.toggleDraftTerm);m.connect("tenor_type_1","onClick",m.setDraftTerm);m.connect("tenor_type_2","onClick",m.toggleDraftTerm);m.connect("tenor_type_3","onClick",m.toggleDraftTerm);m.connect("renew_flag","onClick",m.toggleRenewalDetails);m.connect("renew_flag","onClick",function(){if(!this.get("checked")){dj.byId("rolling_renewal_nb").set("value","");}else{if(!dj.byId("rolling_renewal_flag").get("checked")){dj.byId("rolling_renewal_nb").set("value",m.getLocalization("default_rewnewalNumber"));}}});m.connect("lc_liab_amt","onChange",_1a);m.connect("prod_stat_code","onChange",function(){if(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")=="05"){var _3b=dj.byId("prod_stat_code");if(_3b&&_3b.get("value")==="01"){dj.byId("release_amt").set("readOnly",true);dj.byId("amd_date").set("readOnly",true);}else{dj.byId("release_amt").set("readOnly",false);dj.byId("amd_date").set("readOnly",false);}}});m.connect("release_amt","onBlur",_5);m.connect("advise_renewal_flag","onClick",function(){m.toggleFields(this.get("checked"),null,["advise_renewal_days_nb"]);});m.connect("advise_renewal_flag","onChange",function(){m.toggleFields(this.get("checked"),null,["advise_renewal_days_nb"]);});m.connect("rolling_renewal_flag","onClick",function(){m.toggleFields(this.get("checked"),null,["rolling_renewal_nb","rolling_cancellation_days","rolling_renew_on_code"]);if(!this.get("checked")){dj.byId("rolling_renew_for_nb").set("value","");dj.byId("rolling_renew_for_period").set("value","");dj.byId("rolling_day_in_month").set("value","");if(dj.byId("renew_flag").get("checked")){dj.byId("rolling_renewal_nb").set("value",m.getLocalization("default_rewnewalNumber"));}}});m.connect("rolling_renewal_flag","onChange",function(){m.toggleFields(this.get("checked"),null,["rolling_renewal_nb","rolling_cancellation_days","rolling_renew_on_code"]);if(!this.get("checked")){dj.byId("rolling_renew_for_nb").set("value","");dj.byId("rolling_renew_for_period").set("value","");dj.byId("rolling_day_in_month").set("value","");if(dj.byId("renew_flag").get("checked")){dj.byId("rolling_renewal_nb").set("value",m.getLocalization("default_rewnewalNumber"));}}});m.connect("rolling_renew_on_code","onChange",function(){m.toggleFields(this.get("value")==="03",["rolling_day_in_month"],["rolling_renew_for_nb"],true);if(this.get("value")==="01"){dj.byId("rolling_renew_for_nb").set("value","");dj.byId("rolling_renew_for_period").set("value","");dj.byId("rolling_day_in_month").set("value","");}else{if(dj.byId("rolling_renew_on_code").get("value")==="03"&&dj.byId("rolling_renewal_flag").get("checked")&&dj.byId("renew_for_period").get("value")!==""){dj.byId("rolling_renew_for_period").set("value",dj.byId("renew_for_period").get("value"));}}});m.connect("rolling_renew_for_nb","onBlur",function(){m.validateRollingRenewalFrequency(dj.byId("rolling_renew_for_nb"));});m.connect("renew_for_nb","onBlur",function(){m.validateRollingRenewalFrequency(dj.byId("renew_for_nb"));});m.connect("renew_for_period","onChange",function(){if(dj.byId("rolling_renew_on_code").get("value")==="03"&&dj.byId("rolling_renewal_flag").get("checked")&&dj.byId("renew_for_period").get("value")!==""){dj.byId("rolling_renew_for_period").set("value",dj.byId("renew_for_period").get("value"));}});m.connect("rolling_day_in_month","onBlur",function(){if(dj.byId("rolling_day_in_month").get("value")===0){dj.byId("rolling_day_in_month").set("state","Error");dj.showTooltip(m.getLocalization("dayInMonthZeroNotApplicableError"),dj.byId("rolling_day_in_month").domNode,0);var _3c=function(){dj.hideTooltip(dj.byId("rolling_day_in_month").domNode);};setTimeout(_3c,4500);}});m.connect("rolling_day_in_month","onChange",function(){if(dj.byId("rolling_renew_for_period").get("value")==="D"){this.set("value","");dj.showTooltip(m.getLocalization("dayInMonthNotApplicableForDaysError"),dj.byId("rolling_day_in_month").domNode,0);var _3d=function(){dj.hideTooltip(dj.byId("rolling_day_in_month").domNode);};setTimeout(_3d,1500);}});m.connect("rolling_renew_for_period","onChange",function(){if(dj.byId("rolling_renew_for_period").get("value")==="D"&&!isNaN(dj.byId("rolling_day_in_month").get("value"))){dj.byId("rolling_day_in_month").set("value","");dj.showTooltip(m.getLocalization("dayInMonthNotApplicableForDaysError"),dj.byId("rolling_renew_for_period").domNode,0);var _3e=function(){dj.hideTooltip(dj.byId("rolling_day_in_month").domNode);};setTimeout(_3e,1500);}});if(!m._config.swift2018Enabled){m.connect("lc_amt","onBlur",function(){m.setTnxAmt(this.get("value"));});}var _3f=!dj.byId("tnx_stat_code")||!(dj.byId("tnx_stat_code").get("value")&&(dj.byId("tnx_stat_code").get("value")==="03"||dj.byId("tnx_stat_code").get("value")==="07"));if(_3f){m.connect("lc_amt","onBlur",m.validateDocumentAmtAndLCAmt);m.connect("tnx_amt","onBlur",m.validateDocumentAmtAndLCAmt);}m.connect("last_ship_date","onClick",function(){m.toggleDependentFields(this,dj.byId("narrative_shipment_period"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));});m.connect("last_ship_date","onChange",function(){m.toggleDependentFields(this,dj.byId("narrative_shipment_period"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));});m.connect("tenor_maturity_date","onBlur",m.setDraftTerm);m.connect("tenor_days_type","onBlur",m.setDraftTerm);m.connect("tenor_type_details","onBlur",m.setDraftTerm);m.connect("lc_cur_code","onChange",function(){m.setCurrency(this,["lc_amt"]);m.setCurrency(this,["lc_available_amt","lc_liab_amt"]);});m.connect("tenor_period","onChange",m.setDraftTerm);m.connect("tenor_from_after","onChange",m.setDraftTerm);m.connect("tenor_days","onChange",m.setDraftTerm);m.connect("tenor_days_type","onChange",function(){m.toggleFields((this.get("value")=="99"),null,["tenor_type_details"]);});m.connect("drawee_details_bank_name","onChange",m.initDraweeFields);m.connect("issuing_bank_abbv_name","onChange",m.populateReferences);if(dj.byId("issuing_bank_abbv_name")){m.connect("entity","onChange",function(){dj.byId("issuing_bank_abbv_name").onChange();});}m.connect("issuing_bank_customer_reference","onChange",m.setApplicantReference);m.connect("part_ship_detl_nosend","onChange",function(){var _40=this.get("value");if(m._config.swift2018Enabled){if(_40=="CONDITIONAL"){d.byId("infoMessagePartialShipment").style.display="block";d.byId("infoMessagePartialShipment").style.paddingLeft="250px";}else{d.byId("infoMessagePartialShipment").style.display="none";}}dj.byId("part_ship_detl").set("value",this.get("value"));m.toggleFields(_40&&_40!=="ALLOWED"&&_40!==_4&&_40!=="NONE",null,["part_ship_detl_text_nosend"]);});m.connect("part_ship_detl_text_nosend","onBlur",function(){dj.byId("part_ship_detl").set("value",this.get("value"));});m.connect("tran_ship_detl_nosend","onChange",function(){var _41=this.get("value");if(m._config.swift2018Enabled){if(_41=="CONDITIONAL"){d.byId("infoMessageTranshipment").style.display="block";d.byId("infoMessageTranshipment").style.paddingLeft="250px";}else{d.byId("infoMessageTranshipment").style.display="none";}}dj.byId("tran_ship_detl").set("value",_41);m.toggleFields(_41&&_41!=="ALLOWED"&&_41!==_4&&_41!=="NONE",null,["tran_ship_detl_text_nosend"]);});m.connect("tran_ship_detl_text_nosend","onBlur",function(){dj.byId("tran_ship_detl").set("value",this.get("value"));});m.connect("renew_on_code","onChange",function(){m.toggleFields(this.get("value")==="02",null,["renewal_calendar_date"]);});m.connect("tenor_days","onFocus",m.setDraftDaysReadOnly);m.connect("tenor_period","onFocus",m.setDraftDaysReadOnly);m.connect("tenor_from_after","onFocus",m.setDraftDaysReadOnly);m.connect("tenor_days_type","onFocus",m.setDraftDaysReadOnly);m.connect("draft_term","onFocus",function(){this.set("readOnly",!dj.byId("cr_avl_by_code_5").get("checked"));});m.connect("narrative_shipment_period","onChange",function(){if(m._config.shipment_period_standard===true){m.toggleDependentFields(this,dj.byId("last_ship_date"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));}});m.connect("narrative_shipment_period","onClick",function(){if(m._config.shipment_period_standard===true){m.toggleDependentFields(this,dj.byId("last_ship_date"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));}});m.connect("prod_stat_code","onChange",function(){m.toggleProdStatCodeFields();var _42=this.get("value");if(_42=="07"){m.toggleRequired("tnx_amt",false);}});m.connect("prod_stat_code","onChange",function(){var _43=this.get("value");m.toggleFields(_43&&_43!=="01"&&_43!=="18",["action_req_code"],["iss_date","bo_ref_id"]);if(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("bo_ref_id",false);m.toggleRequired("iss_date",false);m.toggleRequired("lc_liab_amt",false);m.toggleRequired("lc_available_amt",false);}if(_43==="05"||_43==="13"||_43==="15"||_43==="14"||_43==="04"){m.toggleRequired("maturity_date",true);}else{m.toggleRequired("maturity_date",false);}});m.connect("cr_avl_by_code_2","onClick",function(){if(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("drawee_details_bank_address_line_1",false);}});m.connect("cr_avl_by_code_3","onClick",function(){if(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("drawee_details_bank_address_line_1",false);}});m.connect("prod_stat_code","onChange",function(){if(!(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")==="05"&&dj.byId("prod_stat_code").get("value")==="76")){m.updateOutstandingAmount(dj.byId("lc_liab_amt"),dj.byId("org_lc_liab_amt"),dj.byId("lc_amt"));}});m.connect("eucp_flag","onClick",function(){m.toggleFields(this.get("checked"),null,["eucp_details"]);});m.connect("tnx_amt","onChange",function(){if(!(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")==="05"&&dj.byId("prod_stat_code").get("value")==="76")){m.updateOutstandingAmount(dj.byId("lc_liab_amt"),dj.byId("org_lc_liab_amt"));}});m.connect("product_type_code","onChange",function(){if(dj.byId("product_type_code").get("value")!=="99"){d.style("product_type_details_row","display","none");}else{d.style("product_type_details_row","display","block");}});m.connect("standby_rule_code","onChange",function(){m.toggleFields((this.get("value")=="99"),null,["standby_rule_other"]);});m.connect("credit_available_with_bank_type","onChange",function(){var _44=d.trim(dj.byId("credit_available_with_bank_type").get("value")).toLowerCase();if(_44===m.getLocalization("xslCrAnyBank")||_44===m.getLocalization("xslCrAdvisingBank")||_44===m.getLocalization("xslCrIssuingBank")){m.toggleFields(!(_44===m.getLocalization("xslCrAnyBank")||_44===m.getLocalization("xslCrAdvisingBank")||_44===m.getLocalization("xslCrIssuingBank")),["credit_available_with_bank_name","credit_available_with_bank_address_line_1","credit_available_with_bank_address_line_2","credit_available_with_bank_dom","credit_available_with_bank_address_line_4"],null);dj.byId("credit_available_with_bank_name_img").set("disabled",true);}else{m.toggleFields(_44===m._config.other,null,["credit_available_with_bank_name","credit_available_with_bank_address_line_1","credit_available_with_bank_address_line_2","credit_available_with_bank_dom","credit_available_with_bank_address_line_4"],true,true);dj.byId("credit_available_with_bank_name_img").set("disabled",false);}dj.byId("credit_available_with_bank_name").set("value",d.trim(dj.byId("credit_available_with_bank_type").get("value")));});m.connect("prod_stat_code","onChange",function(){var _45=dj.byId("prod_stat_code").get("value"),_46=dj.byId("lc_liab_amt");if(_46&&(_45==="01"||_45==="10"||_45==="06")){_46.set("readOnly",true);_46.set("disabled",true);m.toggleRequired("lc_liab_amt",false);dojo.attr(dj.byId("lc_liab_amt"),"value","");}else{if(_46){_46.set("readOnly",false);_46.set("disabled",false);if(!(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE")){m.toggleRequired("lc_liab_amt",true);}dojo.attr(dj.byId("lc_liab_amt"),"value","");}}var _47=dj.byId("lc_available_amt");if(_47&&(_45==="01"||_45==="10"||_45==="06")){_47.set("readOnly",true);_47.set("disabled",true);m.toggleRequired("lc_available_amt",false);dj.byId("lc_available_amt").set("value","");}else{if(_47){_47.set("readOnly",false);_47.set("disabled",false);if(!(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE")){m.toggleRequired("lc_available_amt",true);}dj.byId("lc_available_amt").set("value","");}}if(dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")=="01"){if(_45==="01"){_46.set("value",0);}else{_46.set("value",dj.byId("lc_amt").get("value"));}}var _48=dj.byId("action_req_code");if(_48&&_45==="12"){_48.set("value","12");_48.set("readOnly",true);_48.set("disabled",true);}if(dj.byId("prod_stat_code")&&_45==="31"&&_48){_48.set("readOnly",true);_48.set("disabled",true);}});m.connect("prod_stat_code","onChange",function(){if(dj.byId("tnx_type_code").get("value")=="03"){var _49=dj.byId("lc_liab_amt").get("value");var _4a;if(dj.byId("prod_stat_code").get("value")=="08"){if(dj.byId("sub_tnx_type_code").get("value")==="01"){_4a=_49+dojo.number.parse(dj.byId("org_inc_amt").get("value"));dj.byId("lc_liab_amt").set("value",_4a);if(dj.byId("tnx_amt")){dj.byId("tnx_amt").set("value",dojo.number.parse(dj.byId("org_inc_amt").get("value")));}}else{if(dj.byId("sub_tnx_type_code").get("value")==="02"){_4a=_49-dojo.number.parse(dj.byId("org_dec_amt").get("value"));dj.byId("lc_liab_amt").set("value",_4a);if(dj.byId("tnx_amt")){dj.byId("tnx_amt").set("value",dojo.number.parse(dj.byId("org_dec_amt").get("value")));}}}}else{if(dj.byId("prod_stat_code").get("value")=="01"){dj.byId("lc_liab_amt").set("value",dj.byId("org_lc_liab_amt").get("value"));if(dj.byId("org_dec_amt").get("value")){if(dj.byId("tnx_amt")){dj.byId("tnx_amt").set("value",dojo.number.parse(dj.byId("org_dec_amt").get("value")));}}if(dj.byId("org_inc_amt").get("value")){if(dj.byId("tnx_amt")){dj.byId("tnx_amt").set("value",dojo.number.parse(dj.byId("org_inc_amt").get("value")));}}}else{if(dj.byId("prod_stat_code").get("value")==="76"&&dj.byId("sub_tnx_type_code").get("value")==="05"){if(dj.byId("release_amt")){dj.byId("lc_liab_amt").set("value",dojo.number.parse(dj.byId("org_lc_liab_amt").get("value"))-dojo.number.parse(dj.byId("release_amt").get("value")));}}}}}});m.connect("lc_available_amt","onBlur",function(){if(dj.byId("lc_amt")&&(dj.byId("lc_amt").get("value")<dj.byId("lc_available_amt").get("value"))){var _4b=function(){var _4c=dijit.byId("lc_available_amt");_4c.focus();_4c.set("state","Error");};m.dialog.show("ERROR",m.getLocalization("AvailLCamtcanNotMoreThanTranAmt"),"",function(){setTimeout(_4b,500);});}});m.connect("prod_stat_code","onChange",function(){var _4d=dj.byId("prod_stat_code").get("value");if(dj.byId("doc_ref_no")&&(_4d==="16"||_4d==="24")){dj.byId("doc_ref_no").set("disabled",false);}else{if(dj.byId("doc_ref_no")){dj.byId("doc_ref_no").set("disabled",true);}}});m.connect("prod_stat_code","onChange",function(){if(dj.byId("lc_type")&&dj.byId("lc_type").get("value")==="02"){if(this.get("value")==="01"){dojo.forEach(dj.byId("fakeform1").getChildren(),function(_4e){var id=_4e.id;if(_4e.required===true){m._config.siMandatoryFields.push(id);m.toggleRequired(id,false);}});m._config.siMandatoryFields.push("narrative_description_goods");m._config.siMandatoryFields.push("narrative_documents_required");m._config.siMandatoryFields.push("advising_bank_name");m._config.siMandatoryFields.push("advising_bank_address_line_1");m.toggleRequired("narrative_description_goods",false);m.toggleRequired("narrative_documents_required",false);m.toggleRequired("advising_bank_name",false);m.toggleRequired("advising_bank_address_line_1",false);}else{if(this.get("value")==="03"){for(var i in m._config.siMandatoryFields){m.toggleRequired(m._config.siMandatoryFields[i],true);}m.toggleTransaction(true);}}}if(m._config.enable_to_edit_customer_details_bank_side=="false"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!==""&&dj.byId("lc_liab_amt")&&dj.byId("lc_available_amt")&&dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")!=="15"&&dj.byId("tnx_type_code").get("value")!=="13"){m.toggleRequired("lc_liab_amt",false);m.toggleRequired("lc_available_amt",false);m.toggleRequired("applicable_rules",false);m.toggleRequired("applicable_rules_text",false);}});m.connect("product_type_code","onChange",function(){if(dj.byId("lc_type")&&dj.byId("lc_type").get("value")==="02"&&dj.byId("product_type_code")){if(dj.byId("product_type_code").get("value")!=="99"){d.style("product_type_details_row","display","none");}else{d.style("product_type_details_row","display","block");}}});m.connect("renew_amt_code_1","onClick",function(){m.setRenewalAmount(this);});m.connect("renew_amt_code_2","onClick",function(){m.setRenewalAmount(this);});m.connect("lc_liab_amt","onChange",function(){if(dj.byId("tnx_type_code")&&dj.byId("sub_tnx_type_code")&&(dj.byId("tnx_type_code").get("value")=="03"||dj.byId("tnx_type_code").get("value")=="01")&&dj.byId("sub_tnx_type_code").get("value")!=="05"){if(dj.byId("prod_stat_code").get("value")==="08"&&dj.byId("lc_liab_amt").get("value")<dj.byId("lc_amt").get("value")&&dj.byId("sub_tnx_type_code").get("value")==="01"){dj.byId("lc_liab_amt").set("value",dojo.number.parse(dj.byId("lc_liab_amt").get("value"))+dojo.number.parse(dj.byId("org_inc_amt").get("value")));}if(dj.byId("prod_stat_code").get("value")!==""&&dj.byId("prod_stat_code").get("value")!=="08"&&dj.byId("prod_stat_code").get("value")!=="01"&&dj.byId("lc_liab_amt").get("value")<dj.byId("lc_amt").get("value")){m.dialog.show("ERROR",m.getLocalization("outstandingAmountShouldBeGraterThanLCAmount"));dj.byId("lc_liab_amt").set("value","");dj.byId("lc_liab_amt").set("state","Error");}}if(dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")=="03"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!=="01"&&dj.byId("prod_stat_code").get("value")==="08"&&dj.byId("sub_tnx_type_code")&&(dj.byId("sub_tnx_type_code").get("value")==="02")){dj.byId("lc_liab_amt").set("value",dojo.number.parse(dj.byId("org_lc_liab_amt").get("value"))-dojo.number.parse(dj.byId("org_dec_amt").get("value")));}if(dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")=="03"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!=="01"&&dj.byId("prod_stat_code").get("value")==="08"&&dj.byId("sub_tnx_type_code")&&(dj.byId("sub_tnx_type_code").get("value")==="01")){dj.byId("lc_liab_amt").set("value",dojo.number.parse(dj.byId("org_lc_liab_amt").get("value"))+dojo.number.parse(dj.byId("org_inc_amt").get("value")));}});m.connect("maturity_date","onBlur",function(){m.validateEnteredGreaterThanCurrentDate();});m.connect("lc_exp_date_type_code","onChange",function(){m.toggleFields((this.get("value")==="01"||this.get("value")==="02"),null,["exp_date"]);if(this.get("value")==="02"){m.toggleRequired("exp_date",false);m.animate("fadeIn",d.byId("exp-event"));m.toggleRequired("exp_event",true);}else{m.animate("fadeOut",d.byId("exp-event"));dj.byId("exp_event").set("value","");m.toggleRequired("exp_event",false);}});m.connect("delv_org","onChange",function(){m.toggleFields((this.get("value")==="99"),null,["delv_org_text"]);});m.connect("applicant_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("applicant_address_line_4").get("displayedValue"),dj.byId("applicant_address_line_4").get("value")]),d.byId("applicant_address_line_4"),["after"],5000);});m.connect("beneficiary_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("beneficiary_address_line_4").get("displayedValue"),dj.byId("beneficiary_address_line_4").get("value")]),d.byId("beneficiary_address_line_4"),["after"],5000);});m.connect("credit_available_with_bank_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("credit_available_with_bank_address_line_4").get("displayedValue"),dj.byId("credit_available_with_bank_address_line_4").get("value")]),d.byId("credit_available_with_bank_address_line_4"),["after"],5000);});m.connect("advising_bank_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("advising_bank_address_line_4").get("displayedValue"),dj.byId("advising_bank_address_line_4").get("value")]),d.byId("advising_bank_address_line_4"),["after"],5000);});m.connect("advise_thru_bank_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("advise_thru_bank_address_line_4").get("displayedValue"),dj.byId("advise_thru_bank_address_line_4").get("value")]),d.byId("advise_thru_bank_address_line_4"),["after"],5000);});m.connect("requested_confirmation_party_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("requested_confirmation_party_address_line_4").get("displayedValue"),dj.byId("requested_confirmation_party_address_line_4").get("value")]),d.byId("requested_confirmation_party_address_line_4"),["after"],5000);});m.connect("drawee_details_bank_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("drawee_details_bank_address_line_4").get("displayedValue"),dj.byId("drawee_details_bank_address_line_4").get("value")]),d.byId("drawee_details_bank_address_line_4"),["after"],5000);});},onFormLoad:function(){if(document.getElementById("amd_no")){m._config.amendmentNumber=document.getElementById("amd_no").value;}if(m._config.shipment_period_standard===false){m._config.earliestShipDate=dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").get("displayedValue"):"";m._config.shipPeriod=dj.byId("ship_period")?dj.byId("ship_period").get("displayedValue"):"";m._config.shipName=dj.byId("ship_name")?dj.byId("ship_name").get("displayedValue"):"";m._config.narrativeShipPeriod=dj.byId("narrative_shipment_period").get("displayedValue")?dj.byId("narrative_shipment_period").get("displayedValue"):"";}m._config.expDate=dj.byId("exp_date")?dj.byId("exp_date").get("displayedValue"):"";if(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("iss_date",false);m.toggleRequired("lc_liab_amt",false);m.toggleRequired("lc_available_amt",false);}if(dijit.byId("action_req_code")){_1=dijit.byId("action_req_code").store.root.options[4].text;_2=dijit.byId("action_req_code").store.root.options[4].value;}if(m._config.swift2018Enabled){m._formLoadSwift2018();}if(dj.byId("credit_available_with_bank_name")){var _4f=d.trim(dj.byId("credit_available_with_bank_type").get("value")).toLowerCase();if(_4f===m.getLocalization("xslCrAnyBank")||_4f===m.getLocalization("xslCrAdvisingBank")||_4f===m.getLocalization("xslCrIssuingBank")){m.toggleFields(!(_4f===m.getLocalization("xslCrAnyBank")||_4f===m.getLocalization("xslCrAdvisingBank")||_4f===m.getLocalization("xslCrIssuingBank")),null,["credit_available_with_bank_name","credit_available_with_bank_address_line_1","credit_available_with_bank_address_line_2","credit_available_with_bank_dom","credit_available_with_bank_address_line_4","credit_available_with_bank_iso_code"],true,false);dj.byId("credit_available_with_bank_name_img").set("disabled",true);}else{m.toggleFields(_4f===m._config.other,null,["credit_available_with_bank_name","credit_available_with_bank_address_line_1","credit_available_with_bank_address_line_2","credit_available_with_bank_dom","credit_available_with_bank_address_line_4"],true,true);}}if(dj.byId("claim_cur_code")&&dj.byId("claim_amt")){m.setCurrency(dj.byId("claim_cur_code"),["claim_amt"]);}if(dj.byId("lc_liab_amt")&&dj.byId("release_amt")){var _50=dojo.number.parse(dj.byId("org_lc_liab_amt").get("value"))||0,_51=dj.byId("release_amt").get("value");if(_51>_50){m.dialog.show("ERROR",m.getLocalization("canNotReleaseTheTransaction"));dj.byId("lc_liab_amt").set("value",_50);}else{var _52=_50-_51;dj.byId("lc_liab_amt").set("value",_52);}}if(dj.byId("prod_stat_code")){_1a();}m.setCurrency(dj.byId("lc_cur_code"),["tnx_amt","lc_amt"]);m.setCurrency(dj.byId("lc_cur_code"),["lc_available_amt","lc_liab_amt"]);var _53=dj.byId("renew_flag");if(_53){d.hitch(_53,m.toggleRenewalDetails,true)();m.toggleFields((dj.byId("renew_on_code").get("value")=="02"),null,["renewal_calendar_date"],true);m.toggleFields(dj.byId("advise_renewal_flag").get("checked"),null,["advise_renewal_days_nb"],true);m.toggleFields(dj.byId("rolling_renewal_flag").get("checked"),null,["rolling_renewal_nb","rolling_cancellation_days","rolling_renew_on_code"],true);if(d.byId("advise_renewal_days_nb")&&d.byId("advise_renewal_days_nb").value==""){dj.byId("advise_renewal_flag").set("checked",false);}var _54=dj.byId("rolling_renew_on_code");if(_54){m.toggleFields(_54.get("value")==="03",["rolling_day_in_month"],["rolling_renew_for_nb"],true);}}var _55=["cr_avl_by_code_1","cr_avl_by_code_2","cr_avl_by_code_3","cr_avl_by_code_4","cr_avl_by_code_5","cr_avl_by_code_6"];d.forEach(_55,function(id){var _56=dj.byId(id);if(_56&&_56.get("checked")){_56.onClick();}});var _57=dj.byId("eucp_flag");if(_57){m.toggleFields(_57.get("checked"),null,["eucp_details"]);}var _58,_59,_5a,_5b;if(dj.byId("cr_avl_by_code_1")){_58=dj.byId("cr_avl_by_code_1").get("checked");}if(dj.byId("cr_avl_by_code_2")){_58=dj.byId("cr_avl_by_code_2").get("checked");}if(dj.byId("cr_avl_by_code_3")){_58=dj.byId("cr_avl_by_code_3").get("checked");}if(dj.byId("cr_avl_by_code_5")){_58=dj.byId("cr_avl_by_code_5").get("checked");}if(!_58&&!_59&&!_5a&&!_5b){m.setDraftTerm();}var _5c=dj.byId("issuing_bank_abbv_name");if(_5c){_5c.onChange();}var _5d=dj.byId("drawee_details_bank_name");if(_5d){_5d.onChange();m.setDraweeDetailBankName();}var _5e=dj.byId("part_ship_detl_nosend");if(_5e){var _5f=_5e.get("value");if(m._config.swift2018Enabled){if(_5f=="CONDITIONAL"){d.byId("infoMessageTranshipment").style.display="block";d.byId("infoMessageTranshipment").style.paddingLeft="250px";}else{d.byId("infoMessageTranshipment").style.display="none";}}m.toggleFields(_5f&&_5f!=="ALLOWED"&&_5f!==_4&&_5f!=="NONE",null,["part_ship_detl_text_nosend"],true);}var _60=dj.byId("part_ship_detl");if(_60&&_5e&&_60.get("value")===""){_60.set("value",_5e.get("value"));}var _61=dj.byId("tran_ship_detl_nosend");if(_61){var _62=_61.get("value");if(m._config.swift2018Enabled){if(_62=="CONDITIONAL"){d.byId("infoMessageTranshipment").style.display="block";d.byId("infoMessageTranshipment").style.paddingLeft="250px";}else{d.byId("infoMessageTranshipment").style.display="none";}}m.toggleFields(_62&&_62!=="ALLOWED"&&_62!==_4&&_62!=="NONE",null,["tran_ship_detl_text_nosend"]);}var _63=dj.byId("tran_ship_detl");if(_63&&_61&&_63.get("value")===""){_63.set("value",_61.get("value"));}if(dj.byId("latest_answer_date")){m.toggleProdStatCodeFields();}if(dj.byId("prod_stat_code").get("value")==="79"||dj.byId("prod_stat_code").get("value")==="78"){dj.byId("action_req_code").set("value","07");dj.byId("action_req_code").set("readOnly",true);}var _64=dj.byId("standby_rule_code");if(_64){m.toggleFields((_64.get("value")=="99"),null,["standby_rule_other"]);}var _65=dj.byId("prod_stat_code"),_66=dj.byId("lc_liab_amt");if(_66&&_65&&(_65.get("value")==="01"||_65.get("value")==="10"||_65.get("value")==="06")){_66.set("readOnly",true);_66.set("disabled",true);}else{if(_66){if(_65.get("value")==="08"){var _67;if(dj.byId("sub_tnx_type_code").get("value")==="01"){_67=_66.get("value")+dojo.number.parse(dj.byId("org_inc_amt").get("value"));dj.byId("lc_liab_amt").set("value",_67);}else{if(dj.byId("sub_tnx_type_code").get("value")==="02"){_67=_66.get("value")-dojo.number.parse(dj.byId("org_dec_amt").get("value"));dj.byId("lc_liab_amt").set("value",_67);}}}_66.set("readOnly",false);_66.set("disabled",false);}}var _68=dj.byId("lc_available_amt");if(_68){if(_65&&(_65.get("value")==="01"||_65.get("value")==="10"||_65.get("value")==="06")){_68.set("readOnly",true);_68.set("disabled",true);}else{_68.set("readOnly",false);_68.set("disabled",false);}}if(dj.byId("prod_stat_code").get("value")==="01"){m.toggleFields(false,["action_req_code"],["iss_date","bo_ref_id"]);dojo.forEach(dj.byId("fakeform1").getChildren(),function(_69){var id=_69.id;if(_69.required===true){m._config.siMandatoryFields.push(id);m.toggleRequired(id,false);}});m._config.siMandatoryFields.push("narrative_description_goods");m._config.siMandatoryFields.push("narrative_documents_required");m._config.siMandatoryFields.push("advising_bank_name");m._config.siMandatoryFields.push("advising_bank_address_line_1");m.toggleRequired("narrative_description_goods",false);m.toggleRequired("narrative_documents_required",false);m.toggleRequired("advising_bank_name",false);m.toggleRequired("advising_bank_address_line_1",false);}if(dj.byId("product_code")&&dj.byId("product_code").get("value")==="SI"){m.connect("prod_stat_code","onChange",function(){if(dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")=="86"){dj.byId("action_req_code").set("value","07");}});}if(dj.byId("claim_reference")&&dj.byId("claim_present_date")&&dj.byId("claim_amt")&&dj.byId("claim_cur_code")){if(dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")==="84"){m.animate("fadeOut",d.byId(_3));m.animate("fadeIn",d.byId("claimDetails"));dj.byId("claim_reference").set("required",true);dj.byId("claim_present_date").set("required",true);dj.byId("claim_amt").set("required",true);dj.byId("claim_cur_code").set("value",dj.byId("lc_cur_code").get("value"));}else{m.animate("fadeOut",d.byId("claimDetails"));m.animate("fadeIn",d.byId(_3));dj.byId("claim_reference").set("disabled",true);dj.byId("claim_present_date").set("disabled",true);dj.byId("claim_amt").set("disabled",true);dj.byId("claim_cur_code").set("disabled",true);dj.byId("claim_reference").set("value","");dj.byId("claim_present_date").set("value",null);dj.byId("claim_amt").set("value","");dj.byId("claim_cur_code").set("value","");}}var _6a=dj.byId("prod_stat_code");if(dj.byId("doc_ref_no")&&_65&&(_65.get("value")==="16"||_65.get("value")==="24")){dj.byId("doc_ref_no").set("disabled",false);}else{if(dj.byId("doc_ref_no")){dj.byId("doc_ref_no").set("disabled",true);}}if(dj.byId("product_type_code")&&dj.byId("product_type_code").get("value")!=="99"){d.style("product_type_details_row","display","none");}else{d.style("product_type_details_row","display","block");}if((_59||_5a)&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("drawee_details_bank_address_line_1",false);}if(_6a.get("value")==="05"||_6a.get("value")==="13"||_6a.get("value")==="15"||_6a.get("value")==="14"||_6a.get("value")==="04"){m.toggleRequired("maturity_date",true);}m.setRenewalAmountOnFormLoad();if(dj.byId("tnx_type_code")&&(dj.byId("tnx_type_code").get("value")==="15"||(dj.byId("tnx_type_code").get("value")==="13"))&&(m._config.enable_to_edit_customer_details_bank_side=="false")){dojo.style("transactionDetails","display","none");}else{if(m._config.enable_to_edit_customer_details_bank_side=="false"){dojo.style("transactionDetails","display","none");var _6b=["standby_rule_other","standby_rule_code","product_type_code","product_type_details","cfm_chrg_brn_by_code_2","cfm_chrg_brn_by_code_1","open_chrg_brn_by_code_1","credit_available_with_bank_name","credit_available_with_bank_address_line_1","credit_available_with_bank_address_line_2","credit_available_with_bank_dom","open_chrg_brn_by_code_2","corr_chrg_brn_by_code_1","corr_chrg_brn_by_code_2","max_cr_desc_code","neg_tol_pct","pstv_tol_pct","lc_liab_amt","lc_amt","lc_cur_code","cfm_inst_code_3","cfm_inst_code_2","cfm_inst_code_1","stnd_by_lc_flag","ntrf_flag","irv_flag","expiry_place","exp_date","iss_date_type_code","exp_date_type_code","entity","applicant_name","applicant_address_line_1","tenor_type_3","applicant_address_line_2","applicant_dom","applicant_country","applicant_reference","applicant_contact_number","applicant_email","alt_applicant_name","issuing_bank_reference","drawee_details_bank_dom","drawee_details_bank_address_line_2","beneficiary_name","beneficiary_address_line_1","tenor_days","tenor_period","tenor_from_after","beneficiary_address_line_2","beneficiary_dom","beneficiary_country","beneficiary_reference","beneficiary_contact_number","beneficiary_email","issuing_bank_type_code","tenor_days_type","drawee_details_bank_name","drawee_details_bank_address_line_1","issuing_bank_name","issuing_bank_address_line_1","issuing_bank_address_line_2","narrative_additional_instructions","advising_bank_name","advising_bank_address_line_1","advising_bank_address_line_2","advising_bank_dom","advising_bank_iso_code","advise_thru_bank_iso_code","advise_thru_bank_reference","advising_bank_reference","narrative_additional_amount","narrative_payment_instructions","narrative_sender_to_receiver","narrative_charges","narrative_period_presentation","narrative_shipment_period","narrative_description_goods","narrative_documents_required","advise_thru_bank_name","advise_thru_bank_address_line_1","advise_thru_bank_address_line_2","advise_thru_bank_dom","inco_place","inco_term","last_ship_date","ship_name","ship_period","earliest_ship_date","mlt_ship_detl","tran_ship_detl_text_nosend","tran_ship_detl_nosend","part_ship_detl_text_nosend","part_ship_detl_nosend","ship_to","ship_discharge","ship_loading","ship_from","draft_term_free_format_text","tenor_type_details","tenor_days_type","tenor_type_99","tenor_days","tenor_period","tenor_from_after","tenor_type_2","tenor_maturity_date","tenor_type_1","cr_avl_by_code_6","cr_avl_by_code_5","draft_term","cr_avl_by_code_4","cr_avl_by_code_3","cr_avl_by_code_2","cr_avl_by_code_1","carrier_detl","applicable_rules","applicable_rules_text","lc_available_amt"];d.forEach(_6b,function(id){var _6c=dj.byId(id);if(_6c){m.toggleRequired(_6c,false);}});}}if(dj.byId("lc_liab_amt")&&dj.byId("release_amt")){var _6d=dojo.number.parse(dj.byId("org_lc_liab_amt").get("value"))||0,_6e=dj.byId("release_amt").get("value");if(_6e>_6d){m.dialog.show("ERROR",m.getLocalization("canNotReleaseTheTransaction"));dj.byId("lc_liab_amt").set("value",_6d);}else{var _6f=_6d-_6e;dj.byId("lc_liab_amt").set("value",_6f);}}if(dj.byId("ntrf_flag")&&dj.byId("narrative_transfer_conditions")){if(dj.byId("ntrf_flag").get("checked")){dj.byId("narrative_transfer_conditions").set("disabled",true);dj.byId("narrative_transfer_conditions").set("value","");document.getElementById("narrative_transfer_conditions_img").style.display="none";}else{dj.byId("narrative_transfer_conditions").set("disabled",false);document.getElementById("narrative_transfer_conditions_img").style.display="block";}}if(dj.byId("lc_exp_date_type_code")&&dj.byId("lc_exp_date_type_code").value=="02"){m.animate("fadeIn",d.byId("exp-event"));m.toggleRequired("exp_event",true);}else{m.animate("fadeOut",d.byId("exp-event"));m.toggleRequired("exp_event",false);}if(dj.byId("delivery_to")){m.getDeliveryTo();dijit.byId("delivery_to").set("value",dj.byId("org_delivery_to").get("value"));m.toggleFields((dj.byId("delivery_to").get("value")==="02"||dj.byId("delivery_to").get("value")==="04"||dj.byId("delivery_to").get("value")==="05"),null,["narrative_delivery_to"]);}if(dj.byId("inco_term_year")){m.getIncoYear();dijit.byId("inco_term_year").set("value",dj.byId("org_term_year").get("value"));}if(dj.byId("inco_term")){if(dj.byId("inco_term_year")&&dj.byId("inco_term_year").get("value")!=""){m.getIncoTerm();}dijit.byId("inco_term").set("value",dj.byId("org_inco_term").get("value"));}var _70=dj.byId("inco_term")?dj.byId("inco_term").get("value"):"";if(_70){m.toggleFields(_70,null,["inco_place"],false,true);}else{m.toggleFields(_70,null,["inco_place"],false,false);}var _71=dj.byId("prod_stat_code");var _72=dj.byId("imp_bill_ref_id");if(_71&&_71.get("value")&&_72){var _73=dj.byId("prod_stat_code").get("value");if(_73==="04"||_73==="07"||_73==="12"||_73==="13"||_73==="05"||_73==="14"||_73==="15"){dj.byId("imp_bill_ref_id").set("disabled",false);}else{dj.byId("imp_bill_ref_id").set("disabled",true);dj.byId("imp_bill_ref_id").set("value","");}}var _74=dj.byId("ship_period");if(_74&&_74.get("value")){_74.onChange();}},beforeSubmitValidations:function(){if(dj.byId("tnx_amt")&&(dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").getValue()!="03"&&dj.byId("tnx_type_code").getValue()!="14"&&!(dj.byId("tnx_type_code").getValue()=="15"&&(dj.byId("prod_stat_code").get("value")=="03"||dj.byId("prod_stat_code").get("value")=="06"||dj.byId("prod_stat_code").get("value")=="08"||dj.byId("prod_stat_code").get("value")=="81")))){if(!m.validateAmount((dj.byId("tnx_amt"))?dj.byId("tnx_amt"):0)){m._config.onSubmitErrorMsg=m.getLocalization("amountcannotzero");dj.byId("tnx_amt").set("value","");return false;}}var _75=true;if(m._config.swift2018Enabled){_75=m._beforeSubmitValidationsSwift2018();if(!_75){return _75;}}if(dj.byId("lc_amt")&&dj.byId("lc_available_amt")&&(dj.byId("lc_amt").get("value")<dj.byId("lc_available_amt").get("value"))){m._config.onSubmitErrorMsg=m.getLocalization("AvailLCamtcanNotMoreThanTranAmt");dj.byId("lc_available_amt").set("value","");return false;}if(dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")==="01"){return true;}else{var _76=dj.byId("sub_tnx_type_code")?dj.byId("sub_tnx_type_code").get("value"):"";if(_76=="05"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!="01"){var _77=dj.byId("release_amt");var _78=dj.byId("org_lc_liab_amt");var _79=dj.byId("release_amt")?dj.byId("release_amt").get("value"):"";var _7a=dojo.number.parse(_78.get("value"))||0;if(_77&&_78&&(_79<=0||_79>_7a)&&_7a!="0"){m._config.onSubmitErrorMsg=m.getLocalization("canNotReleaseTheTransaction");dj.byId("lc_liab_amt").set("value",_7a);return false;}else{if(_7a=="0"){m._config.onSubmitErrorMsg=m.getLocalization("canNotProceedTheTransaction");dj.byId("lc_liab_amt").set("value",_7a);return false;}}}if(dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")=="03"&&_76!="05"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!="01"&&dijit.byId("prv_pod_stat_code")&&dijit.byId("prv_pod_stat_code").get("value")=="06"){m._config.onSubmitErrorMsg=m.getLocalization("canNotProceedTheTransaction");dj.byId("lc_liab_amt").set("value",dojo.number.parse(dijit.byId("org_lc_liab_amt").get("value")));return false;}if(dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")==="84"&&dj.byId("claim_amt")&&dj.byId("claim_amt").get("value")!==""&&dj.byId("tnx_amt")){dj.byId("tnx_amt").set("value",dj.byId("claim_amt").get("value"));}var _7b=dj.byId("current_date");var _7c=dj.byId("claim_present_date");if(_7c&&_7b&&!m.compareDateFields(_7c,_7b)){var _7d=function(){var _7e=dijit.byId("claim_present_date");_7e.focus();_7e.set("state","Error");};m.dialog.show("ERROR",m.getLocalization("claimDateGreaterThanCurrentDateError",[_7c.get("displayedValue"),_7b.get("displayedValue")]),"",function(){setTimeout(_7d,500);});return false;}var _7f=dj.byId("exp_date");var _80=dj.byId("projected_expiry_date");var _81=dj.byId("final_expiry_date");if(_80){if(_7f&&!m.compareDateFields(_7f,_80)){m._config.onSubmitErrorMsg=m.getLocalization("projectedExpDateLessThanTransactionExpDtError",[_80.get("displayedValue"),_7f.get("displayedValue")]);m.showTooltip(m.getLocalization("projectedExpDateLessThanTransactionExpDtError",[_80.get("displayedValue"),_7f.get("displayedValue")]),_80.domNode);return false;}else{if(_81&&!m.compareDateFields(_80,_81)){m._config.onSubmitErrorMsg=m.getLocalization("projectedExpDateGreaterThanFinalExpDtError",[_80.get("displayedValue"),_81.get("displayedValue")]);m.showTooltip(m.getLocalization("projectedExpDateGreaterThanFinalExpDtError",[_80.get("displayedValue"),_81.get("displayedValue")]),_80.domNode);return false;}}}if(_81){if(_7f&&!m.compareDateFields(_7f,_81)){m._config.onSubmitErrorMsg=m.getLocalization("finalExpDateLessThanTransactionExpDtError",[_81.get("displayedValue"),_7f.get("displayedValue")]);m.showTooltip(m.getLocalization("finalExpDateLessThanTransactionExpDtError",[_81.get("displayedValue"),_7f.get("displayedValue")]),_81.domNode);return false;}else{if(_80&&!m.compareDateFields(_80,_81)){m._config.onSubmitErrorMsg=m.getLocalization("finalExpDateLessThanProjectedExpDtError",[_81.get("displayedValue"),_80.get("displayedValue")]);m.showTooltip(m.getLocalization("finalExpDateLessThanProjectedExpDtError",[_81.get("displayedValue"),_80.get("displayedValue")]),_81.domNode);return false;}}}return _b();}}});})(dojo,dijit,misys);dojo.require("misys.client.binding.bank.report_si_client");}